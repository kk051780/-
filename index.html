<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>äººç”Ÿåå·®å€¤ãƒ©ãƒœ â€“ Prototype v1.2.1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --bg-soft: #111827;
      --card: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --accent-strong: #0ea5e9;
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --border: #1f2937;
      --danger: #f97373;
      --success: #4ade80;
      --muted-chip: #111827;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 16px 20px 8px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(to right, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .header-main {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .title-block h1 {
      font-size: 20px;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .title-pill {
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.6);
      color: var(--text-soft);
    }

    .subtitle {
      margin: 4px 0 0;
      font-size: 12px;
      color: var(--text-soft);
    }

    .chip-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 4px;
    }

    .chip {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.3);
      background: rgba(15,23,42,0.7);
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .chip span {
      font-size: 10px;
      opacity: 0.7;
    }

    .tab-bar {
      margin-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tab-btn {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15,23,42,0.8);
      color: var(--text-soft);
      font-size: 12px;
      padding: 6px 10px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.15s ease;
    }

    .tab-btn span.icon {
      font-size: 13px;
    }

    .tab-btn.active {
      background: var(--accent-soft);
      color: var(--accent-strong);
      border-color: rgba(56,189,248,0.5);
      box-shadow: 0 0 0 1px rgba(56,189,248,0.3);
    }

    .tab-btn:hover {
      border-color: rgba(148,163,184,0.8);
    }

    main {
      flex: 1;
      padding: 14px 16px 24px;
      max-width: 1040px;
      width: 100%;
      margin: 0 auto;
    }

    .panel {
      display: none;
      animation: fadeIn 0.2s ease-out;
    }

    .panel.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .panel-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 16px;
    }

    @media (max-width: 840px) {
      .panel-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: radial-gradient(circle at top left, rgba(15,23,42,0.9), var(--card));
      border-radius: 14px;
      border: 1px solid var(--border);
      padding: 14px 14px 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.45);
    }

    .card-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card-title-badge {
      font-size: 10px;
      padding: 1px 6px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.6);
      color: var(--text-soft);
    }

    .card-desc {
      margin: 0;
      font-size: 11px;
      color: var(--text-soft);
    }

    .field-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 8px 10px;
      margin-top: 4px;
    }

    label {
      font-size: 11px;
      color: var(--text-soft);
      display: block;
      margin-bottom: 3px;
    }

    input[type="number"],
    select {
      width: 100%;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text);
      font-size: 12px;
      outline: none;
    }

    input[type="number"]:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56,189,248,0.4);
    }

    .btn-primary {
      margin-top: 10px;
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(to right, #0ea5e9, #22c55e);
      color: #0b1120;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 20px rgba(34,197,94,0.35);
    }

    .btn-primary:hover {
      filter: brightness(1.05);
    }

    .btn-secondary {
      margin-top: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15,23,42,0.9);
      color: var(--text-soft);
      font-size: 11px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .metrics-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 2px;
    }

    .metric-pill {
      padding: 5px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid var(--border);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .metric-value {
      font-weight: 600;
      color: var(--accent-strong);
    }

    .metric-label {
      color: var(--text-soft);
      font-size: 10px;
    }

    .metric-tag {
      font-size: 9px;
      padding: 1px 6px;
      border-radius: 999px;
      background: var(--muted-chip);
      border: 1px solid rgba(148,163,184,0.3);
      color: var(--text-soft);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
      margin-top: 6px;
    }

    th, td {
      padding: 5px 6px;
      border-bottom: 1px solid rgba(31,41,55,0.8);
      text-align: right;
      white-space: nowrap;
    }

    th:first-child,
    td:first-child {
      text-align: left;
    }

    thead tr {
      background: rgba(15,23,42,0.8);
    }

    tbody tr:nth-child(even) {
      background: rgba(15,23,42,0.35);
    }

    .hint {
      font-size: 10px;
      color: var(--text-soft);
      margin-top: 4px;
    }

    .hint-strong {
      color: #e5e7eb;
      font-weight: 500;
    }

    .quiz-list {
      list-style: none;
      padding: 0;
      margin: 6px 0 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 260px;
      overflow: auto;
    }

    .quiz-item {
      border-radius: 10px;
      border: 1px solid var(--border);
      padding: 7px 8px;
      background: rgba(15,23,42,0.85);
    }

    .quiz-q-header {
      font-size: 11px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 3px;
    }

    .quiz-q-text {
      font-size: 11px;
      margin-bottom: 4px;
    }

    .quiz-choices {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 4px;
    }

    .quiz-choice {
      font-size: 11px;
      padding: 5px 6px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #020617;
      cursor: pointer;
      text-align: left;
    }

    .quiz-choice.selected {
      border-color: var(--accent);
      background: rgba(8,47,73,0.9);
    }

    .quiz-choice input {
      display: none;
    }

    .quiz-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-top: 6px;
      font-size: 10px;
      color: var(--text-soft);
    }

    .quiz-footer span.strong {
      color: var(--accent-strong);
      font-weight: 600;
    }

    .result-block {
      margin-top: 4px;
      padding: 6px 8px;
      border-radius: 10px;
      border: 1px solid rgba(148,163,184,0.4);
      background: rgba(15,23,42,0.8);
      font-size: 11px;
    }

    .result-block h4 {
      margin: 0 0 4px;
      font-size: 11px;
    }

    .result-block p {
      margin: 2px 0;
    }

    .coming-soon {
      font-size: 11px;
      color: var(--text-soft);
      margin-top: 4px;
    }

    footer {
      font-size: 10px;
      color: var(--text-soft);
      text-align: center;
      padding: 8px 12px 10px;
      border-top: 1px solid var(--border);
      background: rgba(15,23,42,0.9);
    }
  </style>
</head>
<body>
<header>
  <div class="header-main">
    <div class="title-block">
      <h1>
        äººç”Ÿåå·®å€¤ãƒ©ãƒœ
        <span class="title-pill">Prototype v1.2.1 â€“ SSOTå®Ÿè£…ç‰ˆ</span>
      </h1>
      <p class="subtitle">
        é«˜æ ¡ç”Ÿã€œç¤¾ä¼šäººã¾ã§ã€ã€Œé ­ã€ã€Œå¿ƒã€ã€ŒãŠé‡‘ã€ã€Œä¾¡å€¤è¦³ã€ã‚’åå·®å€¤ã§è¦‹ãˆã‚‹åŒ–ã™ã‚‹å®Ÿé¨“ç‰ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
      </p>
      <div class="chip-row">
        <div class="chip"><span>CORE</span> é«˜æ ¡ç”Ÿ / æ–°å’ / å®¶è¨ˆ</div>
        <div class="chip"><span>LAB</span> åœ°é ­ãƒŸãƒ‹IQ v0 / EQ / ä¾¡å€¤è¦³ï¼ˆè¨­è¨ˆæ¸ˆï¼‰</div>
        <div class="chip"><span>DB</span> äººç”Ÿã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ§‹é€ ï¼ˆå°†æ¥æ‹¡å¼µç”¨ï¼‰</div>
      </div>
    </div>
  </div>
  <div class="tab-bar">
    <button class="tab-btn active" data-panel="panel-highschool">
      <span class="icon">ğŸ“</span>é«˜æ ¡ç”Ÿãƒ¢ãƒ¼ãƒ‰
    </button>
    <button class="tab-btn" data-panel="panel-job">
      <span class="icon">ğŸ’¼</span>æ–°å’ãƒ»å°±æ´»ãƒ¢ãƒ¼ãƒ‰
    </button>
    <button class="tab-btn" data-panel="panel-household">
      <span class="icon">ğŸ </span>å®¶è¨ˆãƒ»DSCRãƒ¢ãƒ¼ãƒ‰
    </button>
    <button class="tab-btn" data-panel="panel-iq">
      <span class="icon">ğŸ§ </span>åœ°é ­ãƒŸãƒ‹IQï¼ˆÎ²ï¼‰
    </button>
    <button class="tab-btn" data-panel="panel-eq">
      <span class="icon">ğŸ’¬</span>EQè¨ºæ–­ï¼ˆè¨­è¨ˆã®ã¿ï¼‰
    </button>
    <button class="tab-btn" data-panel="panel-values">
      <span class="icon">ğŸ§­</span>ä¾¡å€¤è¦³ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¨­è¨ˆã®ã¿ï¼‰
    </button>
  </div>
</header>

<main>
  <!-- é«˜æ ¡ç”Ÿãƒ¢ãƒ¼ãƒ‰ -->
  <section id="panel-highschool" class="panel active">
    <div class="panel-grid">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ“ é«˜æ ¡ç”Ÿãƒ¢ãƒ¼ãƒ‰
              <span class="card-title-badge">ä»Šã®åå·®å€¤ã‹ã‚‰30æ­³ã®å¹´åãƒ¬ãƒ³ã‚¸ã‚’ã–ã£ãã‚Šè©¦ç®—</span>
            </div>
            <p class="card-desc">
              æ–‡ç³»/ç†ç³»ã¨æ¨¡è©¦ã®åå·®å€¤ã‹ã‚‰ã€<strong>ã€Œä»Šã®ã¾ã¾ / +5 / +10ã€</strong>ã§30æ­³ã®æƒ³å®šå¹´åãƒ¬ãƒ³ã‚¸ã¨ç”Ÿæ¶¯å·®é¡ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚
            </p>
          </div>
        </div>
        <div class="field-grid">
          <div>
            <label for="hs-track">æ–‡ç³» / ç†ç³»</label>
            <select id="hs-track">
              <option value="arts">æ–‡ç³»</option>
              <option value="science">ç†ç³»</option>
            </select>
          </div>
          <div>
            <label for="hs-hen">ç¾åœ¨ã®æ¨¡è©¦åå·®å€¤ï¼ˆç›®å®‰ / 40ã€œ70ï¼‰</label>
            <input type="number" id="hs-hen" min="35" max="75" step="1" value="55" />
          </div>
        </div>
        <button class="btn-primary" id="hs-run">
          è¨ˆç®—ã™ã‚‹
          <span>â†’</span>
        </button>
        <p class="hint">
          â€» SSOTã®ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ã<strong class="hint-strong">ç°¡æ˜“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>ã§ã™ã€‚å®Ÿéš›ã®é€²è·¯ãƒ»å¹´åã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
        </p>
      </div>

      <div class="card" id="hs-result-card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ“Š ã‚·ãƒŠãƒªã‚ªåˆ¥ã®30æ­³å¹´å &amp; ç”Ÿæ¶¯å·®é¡ï¼ˆãƒ¢ãƒ‡ãƒ«ï¼‰
            </div>
            <p class="card-desc">
              æ–‡ç³»/ç†ç³»ã¨åå·®å€¤ã”ã¨ã®ãƒ¢ãƒ‡ãƒ«å¹´åã‚’ç·šå½¢è£œé–“ã—ã€<strong>30æ­³æ¨å®šä¸­å¤®å€¤</strong>ã¨<strong>ä¸Šä½20ï¼…ãƒ¬ãƒ³ã‚¸</strong>ã€35å¹´æ›ç®—ã®ç”Ÿæ¶¯å·®é¡ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
            </p>
          </div>
        </div>
        <div id="hs-summary" class="metrics-row"></div>
        <table id="hs-table">
          <thead>
          <tr>
            <th>ã‚·ãƒŠãƒªã‚ª</th>
            <th>åå·®å€¤</th>
            <th>30æ­³å¹´åãƒ»ä¸­å¤®å€¤</th>
            <th>30æ­³å¹´åãƒ»ä¸Šä½20%</th>
            <th>ç”Ÿæ¶¯å·®é¡ï¼ˆ35å¹´ãƒ»ä¸­å¤®å€¤åŸºæº–ï¼‰</th>
          </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- æ–°å’ãƒ»å°±æ´»ãƒ¢ãƒ¼ãƒ‰ -->
  <section id="panel-job" class="panel">
    <div class="panel-grid">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ’¼ æ–°å’ãƒ»å°±æ´»ãƒ¢ãƒ¼ãƒ‰
              <span class="card-title-badge">å¤§å­¦ãƒ»é™¢ãƒ»å°‚æ”»ãƒ»è‹±èªãªã©ã‹ã‚‰å°±è·åŠ›åå·®å€¤ã‚’æ¨å®š</span>
            </div>
            <p class="card-desc">
              å­¦æ­´ï¼ˆå¤§å­¦å¸¯ãƒ»å°‚æ”»ãƒ»å­¦ä½ï¼‰ã¨å€‹äººè¦ç´ ï¼ˆGPA / ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ / è‹±èª / è³‡æ ¼ï¼‰ã‹ã‚‰ã€<strong>å°±è·åŠ›åå·®å€¤</strong>ã¨30æ­³æƒ³å®šå¹´åãƒ¬ãƒ³ã‚¸ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            </p>
          </div>
        </div>

        <div class="field-grid">
          <div>
            <label for="job-univ">å¤§å­¦ãƒ¬ãƒ™ãƒ«</label>
            <select id="job-univ">
              <option value="1">åœ°æ–¹ãƒ»ä¸­å …ã‚¯ãƒ©ã‚¹ï¼ˆä»®ãƒ©ãƒ³ã‚¯1ï¼‰</option>
              <option value="2">æ—¥æ±é§’å°‚ã€œç”£è¿‘ç”²é¾ã‚¯ãƒ©ã‚¹ï¼ˆ2ï¼‰</option>
              <option value="3" selected>MARCHãƒ»é–¢é–¢åŒç«‹ã‚¯ãƒ©ã‚¹ï¼ˆ3ï¼‰</option>
              <option value="4">æ—©æ…¶ãƒ»ä¸Šä½å›½å…¬ç«‹ã‚¯ãƒ©ã‚¹ï¼ˆ4ï¼‰</option>
              <option value="5">æ±å¤§äº¬å¤§ãƒ»è¶…ä¸Šä½å›½å…¬ç«‹ã‚¯ãƒ©ã‚¹ï¼ˆ5ï¼‰</option>
            </select>
          </div>
          <div>
            <label for="job-major">å°‚æ”»ã‚¿ã‚¤ãƒ—</label>
            <select id="job-major">
              <option value="1">æ–‡ç³»ä¸€èˆ¬</option>
              <option value="1.2">çµŒæ¸ˆãƒ»æ³•ãƒ»å•†ç³»</option>
              <option value="1.5" selected>ç†å·¥ç³»ï¼ˆå·¥å­¦ãƒ»æƒ…å ±ãƒ»ç†å­¦ãªã©ï¼‰</option>
              <option value="1.4">åŒ»ç™‚ç³»ï¼ˆè–¬å­¦ãƒ»çœ‹è­·ãªã©ï¼‰</option>
              <option value="2.0">åŒ»å­¦éƒ¨ï¼ˆåŒ»ï¼‰</option>
            </select>
          </div>
          <div>
            <label for="job-degree">æœ€çµ‚å­¦ä½</label>
            <select id="job-degree">
              <option value="0">å­¦éƒ¨å’</option>
              <option value="0.5" selected>ä¿®å£«ï¼ˆMï¼‰</option>
              <option value="1.0">åšå£«ï¼ˆDï¼‰</option>
            </select>
          </div>
          <div>
            <label for="job-gpa">æˆç¸¾ãƒ»GPAå¸¯</label>
            <select id="job-gpa">
              <option value="-0.5">ä¸‹ä½ã€œå¹³å‡æœªæº€</option>
              <option value="0">å¹³å‡ãƒ¬ãƒ™ãƒ«</option>
              <option value="0.5" selected>ä¸Šä½3å‰²ç¨‹åº¦</option>
              <option value="1.0">å­¦å¹´ä¸Šä½ã‚¯ãƒ©ã‚¹</option>
            </select>
          </div>
          <div>
            <label for="job-intern">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³çµŒé¨“</label>
            <select id="job-intern">
              <option value="0">ã»ã¼ç„¡ã—</option>
              <option value="0.5" selected>çŸ­æœŸãƒ»1dayä¸­å¿ƒ</option>
              <option value="1.0">é•·æœŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ãƒ»è¤‡æ•°ç¤¾</option>
            </select>
          </div>
          <div>
            <label for="job-english">è‹±èªåŠ›</label>
            <select id="job-english">
              <option value="0">ç‰¹ã«ãªã—</option>
              <option value="0.5">TOEIC 600ã€œ700 / æº–2ã€œ2ç´š</option>
              <option value="1.0" selected>TOEIC 750ã€œ850 / æº–1ç´šãƒ¬ãƒ™ãƒ«</option>
              <option value="1.5">TOEIC 900+ / 1ç´šãƒ¬ãƒ™ãƒ«</option>
            </select>
          </div>
          <div>
            <label for="job-cert">å°‚é–€è³‡æ ¼</label>
            <select id="job-cert">
              <option value="0">ç‰¹ã«ãªã—</option>
              <option value="0.5">é–¢é€£è³‡æ ¼ã„ãã¤ã‹</option>
              <option value="1.0" selected>å¼·ã‚ã®å°‚é–€è³‡æ ¼ã‚ã‚Š</option>
            </select>
          </div>
        </div>

        <button class="btn-primary" id="job-run">
          å°±è·åŠ›ã‚’è¨ˆç®—
          <span>â†’</span>
        </button>
        <p class="hint">
          â€» SSOTã®ãƒ¢ãƒ‡ãƒ«å¼ã§è¨ˆç®—ã™ã‚‹<strong class="hint-strong">å°±è·åŠ›åå·®å€¤</strong>ã§ã™ã€‚å®Ÿéš›ã®å°±æ´»çµæœã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
        </p>
      </div>

      <div class="card" id="job-result-card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ“Š å°±è·åŠ›åå·®å€¤ã¨30æ­³å¹´åãƒ¬ãƒ³ã‚¸ï¼ˆãƒ¢ãƒ‡ãƒ«ï¼‰
            </div>
            <p class="card-desc">
              å­¦æ ¡å´ã‚¹ã‚³ã‚¢ï¼ˆå¤§å­¦ãƒ©ãƒ³ã‚¯ï¼‹å°‚æ”»ï¼‹å­¦ä½ï¼‰ã¨å€‹äººå´ã‚¹ã‚³ã‚¢ï¼ˆGPA / ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ / è‹±èª / è³‡æ ¼ï¼‰ã‹ã‚‰å°±è·åŠ›åå·®å€¤ã‚’ç®—å‡ºã—ã¾ã™ã€‚
            </p>
          </div>
        </div>

        <div id="job-summary" class="metrics-row"></div>

        <table id="job-table">
          <thead>
          <tr>
            <th>æŒ‡æ¨™</th>
            <th>ã‚¹ã‚³ã‚¢</th>
            <th>ã‚³ãƒ¡ãƒ³ãƒˆ</th>
          </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="result-block" id="job-comment"></div>
      </div>
    </div>
  </section>

  <!-- å®¶è¨ˆãƒ»DSCRãƒ¢ãƒ¼ãƒ‰ -->
  <section id="panel-household" class="panel">
    <div class="panel-grid">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ  å®¶è¨ˆãƒ»DSCRãƒ¢ãƒ¼ãƒ‰
              <span class="card-title-badge">å®¶è¨ˆã®å®‰å…¨åº¦ã¨FIå¹´æ•°ã‚’åå·®å€¤ã§è¦‹ã‚‹</span>
            </div>
            <p class="card-desc">
              å¹´åãƒ»ç”Ÿæ´»è²»ãƒ»ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆãƒ»é‡‘èè³‡ç”£ã‹ã‚‰ã€å®¶è¨ˆDSCRï¼ˆå‚µå‹™è¿”æ¸ˆä½™åŠ›ï¼‰ã¨FIå¹´æ•°ï¼ˆè³‡ç”£ã ã‘ã§ä½•å¹´æš®ã‚‰ã›ã‚‹ã‹ï¼‰ã‚’è©¦ç®—ã—ã¾ã™ã€‚
            </p>
          </div>
        </div>

        <div class="field-grid">
          <div>
            <label for="hh-income">ä¸–å¸¯å¹´åï¼ˆä¸‡å††/å¹´ãƒ»ç¨å¼•å‰ï¼‰</label>
            <input type="number" id="hh-income" min="0" step="10" value="900" />
          </div>
          <div>
            <label for="hh-expense">å¹´é–“ç”Ÿæ´»è²»ï¼ˆä¸‡å††/å¹´ï¼‰</label>
            <input type="number" id="hh-expense" min="0" step="5" value="400" />
          </div>
          <div>
            <label for="hh-loan">å¹´é–“ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆé¡ï¼ˆä¸‡å††/å¹´ï¼‰</label>
            <input type="number" id="hh-loan" min="0" step="5" value="180" />
          </div>
          <div>
            <label for="hh-assets">é‡‘èè³‡ç”£ï¼ˆä¸‡å††ï¼‰</label>
            <input type="number" id="hh-assets" min="0" step="50" value="800" />
          </div>
        </div>

        <button class="btn-primary" id="hh-run">
          å®¶è¨ˆåå·®å€¤ã‚’è¨ˆç®—
          <span>â†’</span>
        </button>
        <p class="hint">
          â€» DSCR â‰¥ 1.3 ã§ã€Œã‚„ã‚„å®‰å…¨ã€ã€1.5ã€œ2.0ã§ã€Œã‹ãªã‚Šä½™è£•ã€ã¨ã„ã£ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚
        </p>
      </div>

      <div class="card" id="hh-result-card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ“Š å®¶è¨ˆDSCRãƒ»FIå¹´æ•°ãƒ»ç·åˆåå·®å€¤
            </div>
            <p class="card-desc">
              SSOTã®ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ãã€DSCRãƒ»FIå¹´æ•°ã‚’åå·®å€¤ã‚¹ã‚±ãƒ¼ãƒ«ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦å®¶è¨ˆãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’è©•ä¾¡ã—ã¾ã™ã€‚
            </p>
          </div>
        </div>

        <div id="hh-summary" class="metrics-row"></div>

        <table id="hh-table">
          <thead>
          <tr>
            <th>æŒ‡æ¨™</th>
            <th>å€¤</th>
            <th>åå·®å€¤ï¼ˆãƒ¢ãƒ‡ãƒ«ï¼‰</th>
            <th>ã‚³ãƒ¡ãƒ³ãƒˆ</th>
          </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="result-block" id="hh-comment"></div>
      </div>
    </div>
  </section>

  <!-- åœ°é ­ãƒŸãƒ‹IQï¼ˆç°¡æ˜“ç‰ˆï¼‰ -->
  <section id="panel-iq" class="panel">
    <div class="panel-grid">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ§  åœ°é ­ãƒŸãƒ‹IQãƒãƒ£ãƒ¬ãƒ³ã‚¸ v0
              <span class="card-title-badge">12å•ãƒ»ãƒ¢ãƒ‡ãƒ«åå·®å€¤ï¼ˆÎ²ç‰ˆãƒ»ã‚µãƒ³ãƒ—ãƒ«ç”¨ï¼‰</span>
            </div>
            <p class="card-desc">
              è«–ç†ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»è¨€èªãƒ»ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã®4ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰ãªã‚‹12å•ã®ãƒŸãƒ‹ãƒ†ã‚¹ãƒˆã§ã™ã€‚<strong>èªçŸ¥ç³»ã®åœ°é ­åå·®å€¤</strong>ã¨ã–ã£ãã‚Šãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’è¿”ã—ã¾ã™ã€‚
            </p>
          </div>
        </div>

        <ul class="quiz-list" id="iq-quiz-list"></ul>

        <div class="quiz-footer">
          <div>
            <span class="strong" id="iq-progress-text">0 / 12 å•</span> é¸æŠæ¸ˆã¿
          </div>
          <div>
            <span>ã‚«ãƒ†ã‚´ãƒªï¼šL = è«–ç†, P = ãƒ‘ã‚¿ãƒ¼ãƒ³, V = è¨€èª, M = è¨˜æ†¶</span>
          </div>
        </div>

        <button class="btn-primary" id="iq-run">
          åœ°é ­åå·®å€¤ã‚’ç®—å‡º
          <span>â†’</span>
        </button>
        <button class="btn-secondary" id="iq-reset">
          åˆæœŸåŒ–ã—ã¦ã‚„ã‚Šç›´ã™
        </button>
        <p class="hint">
          â€» v0ã¯ã€Œã‚µãƒ³ãƒ—ãƒ«å•é¡Œï¼‹ãƒ¢ãƒ‡ãƒ«åˆ†å¸ƒã€ã«åŸºã¥ãè©¦é¨“çš„ãªã‚¹ã‚³ã‚¢ã§ã™ã€‚å°†æ¥ã€å•é¡Œãƒãƒ³ã‚¯ã¨å®Ÿæ¸¬åˆ†å¸ƒã§ç²¾åº¦ã‚’é«˜ã‚ã¦ã„ãã¾ã™ã€‚
        </p>
      </div>

      <div class="card" id="iq-result-card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ“Š åœ°é ­åå·®å€¤ï¼ˆèªçŸ¥ï¼‰ã¨ç°¡æ˜“ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
            </div>
            <p class="card-desc">
              ç”Ÿã‚¹ã‚³ã‚¢ã‚’SSOTå®šç¾©ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆå¹³å‡6 / SD2æƒ³å®šï¼‰ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€åœ°é ­åå·®å€¤ã¨4ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®å¼·ã¿ãƒ»å¼±ã¿ã‚’æ¨å®šã—ã¾ã™ã€‚
            </p>
          </div>
        </div>

        <div id="iq-summary" class="metrics-row"></div>

        <div class="result-block" id="iq-detail">
          <p>12å•ã«å›ç­”ã—ãŸå¾Œã€ã€Œåœ°é ­åå·®å€¤ã‚’ç®—å‡ºã€ã‚’æŠ¼ã™ã¨çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
        </div>
      </div>
    </div>
  </section>

  <!-- EQè¨ºæ–­ï¼ˆè¨­è¨ˆã®ã¿ï¼‰ -->
  <section id="panel-eq" class="panel">
    <div class="panel-grid">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ’¬ EQè¨ºæ–­ï¼ˆè¨­è¨ˆã®ã¿ãƒ»å®Ÿè£…äºˆå®šï¼‰
              <span class="card-title-badge">è‡ªå·±ç†è§£ / è‡ªå·±åˆ¶å¾¡ / å…±æ„Ÿ / å¯¾äººã‚¹ã‚­ãƒ« / ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§</span>
            </div>
            <p class="card-desc">
              SSOTã§ã¯ã€EQã‚’5è»¸ï¼ˆè‡ªå·±ç†è§£ / è‡ªå·±åˆ¶å¾¡ / å…±æ„Ÿ / å¯¾äººã‚¹ã‚­ãƒ« / ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ï¼‰ã§åå·®å€¤åŒ–ã™ã‚‹è¨­è¨ˆã«ãªã£ã¦ã„ã¾ã™ã€‚ã“ã®ç”»é¢ã¯<strong>å®Ÿè£…æº–å‚™ç”¨ã‚¹ãƒšãƒ¼ã‚¹</strong>ã§ã™ã€‚
            </p>
          </div>
        </div>
        <p class="coming-soon">
          ãƒ»Likertå½¢å¼ï¼ˆ1ã€œ5ï¼‰è³ªå•ï¼šå„è»¸ 4ã€œ6å•ã‚’äºˆå®š<br />
          ãƒ»åˆè¨ˆã‚¹ã‚³ã‚¢ã‚’ 0ã€œ100 â†’ åå·®å€¤30ã€œ70ã«å¤‰æ›<br />
          ãƒ»èªçŸ¥ç³»ï¼ˆåœ°é ­ï¼‰ã¨ã®çµ„ã¿åˆã‚ã›ã§ã€Œã‚¿ã‚¤ãƒ—åˆ¤å®šã€ã€Œå‘ã„ã¦ã„ã‚‹åƒãæ–¹ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆäºˆå®š
        </p>
        <p class="coming-soon">
          æ¬¡ã®ã‚µã‚¤ã‚¯ãƒ«ä»¥é™ã§ã€ã“ã®ã‚¿ãƒ–ã«<strong>å…·ä½“çš„ãªè³ªå•ç¥¨UI</strong>ã¨<strong>ã‚¹ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯</strong>ã‚’å®Ÿè£…ã—ã€äººç”Ÿã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã®EQãƒ–ãƒ­ãƒƒã‚¯ã¨æ¥ç¶šã—ã¾ã™ã€‚
        </p>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ§© EQ Ã— åœ°é ­ Ã— ä¾¡å€¤è¦³ ã®çµ„ã¿åˆã‚ã›ã‚¤ãƒ¡ãƒ¼ã‚¸
            </div>
          </div>
        </div>
        <p class="card-desc">
          EQè¨ºæ–­ãŒå®Ÿè£…ã•ã‚Œã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼ˆä¾‹ï¼‰ï¼š
        </p>
        <ul class="hint">
          <li>ãƒ»EQç·åˆï¼šåå·®å€¤ 52</li>
          <li>ãƒ»è‡ªå·±åˆ¶å¾¡ï¼šåå·®å€¤ 60 â†’ æ„Ÿæƒ…ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãŒå¾—æ„</li>
          <li>ãƒ»å…±æ„Ÿï¼šåå·®å€¤ 55 â†’ äººã®æ°—æŒã¡ã«æ°—ã¥ãã‚„ã™ã„</li>
          <li>ãƒ»å¯¾äººã‚¹ã‚­ãƒ«ï¼šåå·®å€¤ 48 â†’ å¤§äººæ•°ã‚ˆã‚Šå°‘äººæ•°ã®æ–¹ãŒå¾—æ„</li>
          <li>ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ï¼šåå·®å€¤ 58 â†’ ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ç’°å¢ƒã§ã‚‚æ¯”è¼ƒçš„å®‰å®š</li>
        </ul>
        <p class="card-desc">
          ã“ã‚Œã‚’åœ°é ­ãƒ†ã‚¹ãƒˆãƒ»ä¾¡å€¤è¦³ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨çµ„ã¿åˆã‚ã›ã¦ã€ã€Œæ•™è‚²ãƒ»åŒ»ç™‚ãƒ»äººäº‹ã€ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—å‘ãã€ã€Œå…¬å‹™å“¡ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©å‘ãã€ãªã©ã®
          <strong>é©æ€§ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ææ¡ˆ</strong>ã«ä½¿ã£ã¦ã„ãã¾ã™ã€‚
        </p>
      </div>
    </div>
  </section>

  <!-- ä¾¡å€¤è¦³ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¨­è¨ˆã®ã¿ï¼‰ -->
  <section id="panel-values" class="panel">
    <div class="panel-grid">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ§­ ä¾¡å€¤è¦³ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¨­è¨ˆã®ã¿ãƒ»å®Ÿè£…äºˆå®šï¼‰
              <span class="card-title-badge">æˆåŠŸ / å®‰å®š / è‡ªç”± / æˆé•· / è²¢çŒ® / ä»²é–“ / å†’é™º ã®7è»¸</span>
            </div>
            <p class="card-desc">
              SSOTã§ã¯ã€ä¾¡å€¤è¦³ã‚’7è»¸ï¼ˆæˆåŠŸãƒ»é”æˆ / å®‰å®šãƒ»å®‰å…¨ / è‡ªç”±ãƒ»è‡ªå¾‹ / æˆé•·ãƒ»å­¦ç¿’ / è²¢çŒ®ãƒ»ã‚±ã‚¢ / ä»²é–“ãƒ»æ‰€å± / å†’é™ºãƒ»åˆºæ¿€ï¼‰ã§ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã™ã‚‹è¨­è¨ˆã«ãªã£ã¦ã„ã¾ã™ã€‚
            </p>
          </div>
        </div>
        <p class="coming-soon">
          ãƒ»Likertè³ªå•ï¼‹å¼·åˆ¶äºŒæŠã§å„è»¸ 0ã€œ100 â†’ åå·®å€¤åŒ–<br />
          ãƒ»ãƒˆãƒƒãƒ—3è»¸ãƒ»ãƒœãƒˆãƒ 1è»¸ã‚’ã€Œä¾¡å€¤è¦³ã®å„ªå…ˆé †ä½ã€ã¨ã—ã¦è¡¨ç¤º<br />
          ãƒ»åœ°é ­ãƒ»EQãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨æ›ã‘åˆã‚ã›ã¦ã€Œå‘ã„ã¦ã„ã‚‹åƒãæ–¹ãƒ»æŠ•è³‡ã‚¹ã‚¿ã‚¤ãƒ«ã€ã‚’ææ¡ˆäºˆå®š
        </p>
        <p class="coming-soon">
          ã“ã®ã‚¿ãƒ–ã¯<strong>å¾Œç¶šã‚µã‚¤ã‚¯ãƒ«ã§ã®UIå®Ÿè£…ç”¨ã‚¹ãƒšãƒ¼ã‚¹</strong>ã¨ã—ã¦ç¢ºä¿ã—ã¦ã‚ã‚Šã¾ã™ã€‚  
          ç§»ç®¡æ™‚ã¯ã€ã“ã“ã«è³ªå•ç¥¨ã¨ã‚¹ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½è¨˜ã™ã‚Œã°äººç”Ÿã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã®ä¾¡å€¤è¦³ãƒ–ãƒ­ãƒƒã‚¯ã¨è‡ªå‹•çš„ã«æ¥ç¶šã§ãã¾ã™ã€‚
        </p>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              ğŸ”— äººç”Ÿãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®æ¥ç¶šã‚¤ãƒ¡ãƒ¼ã‚¸
            </div>
          </div>
        </div>
        <p class="card-desc">
          ä¾¡å€¤è¦³7è»¸ã®åå·®å€¤ã¯ã€äººç”Ÿã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã® <code>metrics</code> ãƒ–ãƒ­ãƒƒã‚¯ã«æ¬¡ã®ã‚ˆã†ã«ä¿å­˜ã•ã‚Œã¾ã™ï¼š
        </p>
        <pre class="hint" style="white-space: pre-wrap; background: rgba(15,23,42,0.85); padding: 8px; border-radius: 8px; border: 1px solid var(--border);">
"val_success_hensachi": 63,
"val_stability_hensachi": 55,
"val_autonomy_hensachi": 58,
"val_growth_hensachi": 61,
"val_contribution_hensachi": 50,
"val_affiliation_hensachi": 47,
"val_adventure_hensachi": 52
        </pre>
        <p class="card-desc">
          ã“ã‚Œã«ã‚ˆã‚Šã€ã€ŒæˆåŠŸÃ—æˆé•·Ã—è‡ªç”±ãŒé«˜ã„äººã€ã€Œè²¢çŒ®Ã—å®‰å®šÃ—ä»²é–“ãŒé«˜ã„äººã€ãªã©ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼åˆ†æã‚„ã€ã€Œä¼¼ãŸä¾¡å€¤è¦³ã®äººãŸã¡ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã®æŠ½å‡ºãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
        </p>
      </div>
    </div>
  </section>
</main>

<footer>
  äººç”Ÿåå·®å€¤ãƒ©ãƒœ â€“ SSOT v1.2 æº–æ‹ ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ï¼ˆå˜ä¸€HTMLï¼‰ã€‚è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã™ã‚‹ãƒ¢ãƒ‡ãƒ«ç‰ˆã§ã™ã€‚
</footer>

<script>
  // ===== å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =====
  function clamp(v, min, max) {
    return Math.min(max, Math.max(min, v));
  }

  function roundTo(v, digits) {
    const p = Math.pow(10, digits);
    return Math.round(v * p) / p;
  }

  function fmtMoneyMan(v) {
    if (isNaN(v)) return "-";
    return v.toLocaleString("ja-JP") + " ä¸‡å††";
  }

  // ===== ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ =====
  (function initTabs() {
    const tabs = document.querySelectorAll(".tab-btn");
    const panels = document.querySelectorAll(".panel");
    tabs.forEach(btn => {
      btn.addEventListener("click", () => {
        tabs.forEach(b => b.classList.remove("active"));
        panels.forEach(p => p.classList.remove("active"));
        btn.classList.add("active");
        const id = btn.getAttribute("data-panel");
        const panel = document.getElementById(id);
        if (panel) panel.classList.add("active");
      });
    });
  })();

  // ===== é«˜æ ¡ç”Ÿãƒ¢ãƒ¼ãƒ‰ =====
  function interpolateIncomeMedian(h) {
    const anchors = [
      { h: 45, y: 350 },
      { h: 50, y: 400 },
      { h: 55, y: 500 },
      { h: 60, y: 600 },
      { h: 65, y: 700 }
    ];
    h = clamp(h, 40, 70);
    if (h <= anchors[0].h) {
      const a = anchors[0];
      return a.y - (a.h - h) * 10;
    }
    if (h >= anchors[anchors.length - 1].h) {
      const a = anchors[anchors.length - 1];
      return a.y + (h - a.h) * 10;
    }
    for (let i = 0; i < anchors.length - 1; i++) {
      const a = anchors[i];
      const b = anchors[i + 1];
      if (h >= a.h && h <= b.h) {
        const t = (h - a.h) / (b.h - a.h);
        return a.y + (b.y - a.y) * t;
      }
    }
    return 400;
  }

  function calcHsScenario(track, baseHen) {
    const trackFactor = track === "science" ? 1.1 : 1.0;
    const scenarios = [
      { label: "ä»Šã®ã¾ã¾", delta: 0 },
      { label: "+5ã‚’ç›®æŒ‡ã—ãŸå ´åˆ", delta: 5 },
      { label: "+10ã‚’ç›®æŒ‡ã—ãŸå ´åˆ", delta: 10 }
    ];
    const rows = [];
    let baseMedian = null;
    scenarios.forEach(sc => {
      let h = baseHen + sc.delta;
      h = Math.min(h, 65);
      const median0 = interpolateIncomeMedian(h);
      const median = Math.round(median0 * trackFactor);
      const p80 = Math.round(median * 1.2);
      rows.push({ label: sc.label, h, median, p80 });
      if (sc.delta === 0) baseMedian = median;
    });
    rows.forEach(r => {
      const diffPerYear = Math.max(0, r.median - baseMedian);
      r.lifetimeDiff = diffPerYear * 35;
    });
    return rows;
  }

  (function initHighschool() {
    const btn = document.getElementById("hs-run");
    const trackEl = document.getElementById("hs-track");
    const henEl = document.getElementById("hs-hen");
    const tbody = document.querySelector("#hs-table tbody");
    const summary = document.getElementById("hs-summary");

    function render() {
      const rawHen = parseFloat(henEl.value);
      const hen = clamp(isNaN(rawHen) ? 50 : rawHen, 35, 75);
      if (hen !== rawHen) {
        henEl.value = hen;
      }
      const track = trackEl.value;
      const rows = calcHsScenario(track, hen);

      tbody.innerHTML = "";
      rows.forEach(r => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${r.label}</td>
          <td>${r.h.toFixed(1)}</td>
          <td>${fmtMoneyMan(r.median)}</td>
          <td>${fmtMoneyMan(r.p80)}</td>
          <td>${fmtMoneyMan(r.lifetimeDiff)}</td>
        `;
        tbody.appendChild(tr);
      });

      const base = rows[0];
      const plus5 = rows[1];
      const plus10 = rows[2];
      summary.innerHTML = "";

      const makePill = (title, value, tag, tone) => {
        const div = document.createElement("div");
        div.className = "metric-pill";
        const labelDiv = document.createElement("div");
        labelDiv.className = "metric-label";
        labelDiv.textContent = title;
        const valueDiv = document.createElement("div");
        valueDiv.className = "metric-value";
        valueDiv.textContent = value;
        if (tone === "good") valueDiv.style.color = "var(--success)";
        if (tone === "warn") valueDiv.style.color = "var(--danger)";
        const tagSpan = document.createElement("span");
        tagSpan.className = "metric-tag";
        tagSpan.textContent = tag;
        div.appendChild(labelDiv);
        div.appendChild(valueDiv);
        div.appendChild(tagSpan);
        return div;
      };

      const diff5 = plus5.lifetimeDiff;
      const diff10 = plus10.lifetimeDiff;

      summary.appendChild(
        makePill(
          "ä»Šã®åå·®å€¤ï¼ˆå…¥åŠ›ï¼‰",
          hen.toFixed(1),
          track === "science" ? "ç†ç³»ãƒ¢ãƒ‡ãƒ«" : "æ–‡ç³»ãƒ¢ãƒ‡ãƒ«",
          null
        )
      );
      summary.appendChild(
        makePill(
          "+5ã‚·ãƒŠãƒªã‚ªã®ç”Ÿæ¶¯å·®é¡",
          fmtMoneyMan(diff5),
          "+5ã®ä¾¡å€¤ï¼ˆ35å¹´æ›ç®—ï¼‰",
          "good"
        )
      );
      summary.appendChild(
        makePill(
          "+10ã‚·ãƒŠãƒªã‚ªã®ç”Ÿæ¶¯å·®é¡",
          fmtMoneyMan(diff10),
          "+10ã®ä¾¡å€¤ï¼ˆ35å¹´æ›ç®—ï¼‰",
          "good"
        )
      );
      summary.appendChild(
        makePill(
          "ãƒ™ãƒ¼ã‚¹30æ­³å¹´åï¼ˆä¸­å¤®å€¤ï¼‰",
          fmtMoneyMan(base.median),
          "ä»Šã®ã¾ã¾",
          null
        )
      );
    }

    btn.addEventListener("click", render);
    render();
  })();

  // ===== æ–°å’ãƒ»å°±æ´»ãƒ¢ãƒ¼ãƒ‰ =====
  function calcJobScores(params) {
    const {
      univRank,
      majorType,
      degreeLevel,
      gpaBand,
      intern,
      english,
      cert
    } = params;

    const schoolRaw = 20 * univRank + 8 * majorType + 6 * degreeLevel;
    const schoolScore = clamp(schoolRaw / 1.2, 0, 100);

    const indivRaw =
      8 * gpaBand +
      6 * intern +
      6 * english +
      6 * cert;
    const indivScore = clamp((indivRaw / 29) * 100, 0, 100);

    const totalScore = 0.6 * schoolScore + 0.4 * indivScore;
    const hensachiJob = clamp(Math.round(50 + (totalScore - 50) * 0.4), 30, 75);

    const medianIncome = Math.round(350 + (hensachiJob - 50) * 8);
    const p80Income = Math.round(medianIncome * 1.25);

    return {
      schoolScore: roundTo(schoolScore, 1),
      indivScore: roundTo(indivScore, 1),
      totalScore: roundTo(totalScore, 1),
      hensachiJob,
      medianIncome,
      p80Income
    };
  }

  (function initJob() {
    const runBtn = document.getElementById("job-run");
    const summary = document.getElementById("job-summary");
    const tbody = document.querySelector("#job-table tbody");
    const commentEl = document.getElementById("job-comment");

    function render() {
      const univRank = parseFloat(document.getElementById("job-univ").value);
      const majorType = parseFloat(document.getElementById("job-major").value);
      const degreeLevel = parseFloat(document.getElementById("job-degree").value);
      const gpaBand = parseFloat(document.getElementById("job-gpa").value);
      const intern = parseFloat(document.getElementById("job-intern").value);
      const english = parseFloat(document.getElementById("job-english").value);
      const cert = parseFloat(document.getElementById("job-cert").value);

      const res = calcJobScores({
        univRank,
        majorType,
        degreeLevel,
        gpaBand,
        intern,
        english,
        cert
      });

      summary.innerHTML = "";

      const makePill = (label, value, tag) => {
        const div = document.createElement("div");
        div.className = "metric-pill";
        const labelDiv = document.createElement("div");
        labelDiv.className = "metric-label";
        labelDiv.textContent = label;
        const valueDiv = document.createElement("div");
        valueDiv.className = "metric-value";
        valueDiv.textContent = value;
        const tagSpan = document.createElement("span");
        tagSpan.className = "metric-tag";
        tagSpan.textContent = tag;
        div.appendChild(labelDiv);
        div.appendChild(valueDiv);
        div.appendChild(tagSpan);
        return div;
      };

      summary.appendChild(
        makePill("å°±è·åŠ›åå·®å€¤", res.hensachiJob, "ãƒ¢ãƒ‡ãƒ«ã‚¹ã‚³ã‚¢")
      );
      summary.appendChild(
        makePill("30æ­³å¹´åä¸­å¤®å€¤", fmtMoneyMan(res.medianIncome), "ãƒ¢ãƒ‡ãƒ«æ¨å®š")
      );
      summary.appendChild(
        makePill("30æ­³å¹´åãƒ»ä¸Šä½20%", fmtMoneyMan(res.p80Income), "ãƒ¢ãƒ‡ãƒ«æ¨å®š")
      );

      tbody.innerHTML = "";
      const rows = [
        {
          label: "å­¦æ ¡å´ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«",
          value: res.schoolScore.toFixed(1),
          comment: "å¤§å­¦ãƒ¬ãƒ™ãƒ«ãƒ»å°‚æ”»ãƒ»å­¦ä½ã«ã‚ˆã‚‹åŸºç¤ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«"
        },
        {
          label: "å€‹äººå´ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«",
          value: res.indivScore.toFixed(1),
          comment: "GPAãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ãƒ»è‹±èªãƒ»è³‡æ ¼ãªã©ã®ç©ã¿ä¸Šã’åº¦åˆã„"
        },
        {
          label: "åˆæˆã‚¹ã‚³ã‚¢",
          value: res.totalScore.toFixed(1),
          comment: "å­¦æ ¡6ï¼šå€‹äºº4ã§åˆæˆã—ãŸå°±è·åŠ›ã‚¹ã‚³ã‚¢"
        }
      ];
      rows.forEach(r => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${r.label}</td>
          <td>${r.value}</td>
          <td>${r.comment}</td>
        `;
        tbody.appendChild(tr);
      });

      let posComment;
      if (res.hensachiJob >= 65) {
        posComment = "å°±è·åŠ›ã¯ä¸Šä½ã‚¾ãƒ¼ãƒ³ï¼ˆåå·®å€¤65ä»¥ä¸Šï¼‰ã«ã‚ã‚Šã€é¸æŠè‚¢ã¯ã‹ãªã‚Šåºƒã„ãƒ¬ãƒ³ã‚¸ã«å…¥ã‚Šã‚„ã™ã„ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚";
      } else if (res.hensachiJob >= 55) {
        posComment = "å°±è·åŠ›ã¯ã‚„ã‚„ä¸Šä½ã€œä¸Šä½å¯„ã‚Šï¼ˆåå·®å€¤55ã€œ65ï¼‰ã§ã€å¿—æœ›æ¥­ç•Œãƒ»è·ç¨®æ¬¡ç¬¬ã§ã¯ååˆ†æˆ¦ãˆã‚‹ãƒ¬ãƒ³ã‚¸ã§ã™ã€‚";
      } else if (res.hensachiJob >= 45) {
        posComment = "å°±è·åŠ›ã¯ãŠãŠã‚€ã­å¹³å‡ãƒ¬ãƒ³ã‚¸ï¼ˆåå·®å€¤45ã€œ55ï¼‰ã§ã€æˆ¦ã„æ–¹ã®å·¥å¤«ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ãƒ»ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãªã©ï¼‰ãŒåŠ¹ã„ã¦ãã¾ã™ã€‚";
      } else {
        posComment = "å°±è·åŠ›ã¯ãƒ¢ãƒ‡ãƒ«ä¸Šã‚„ã‚„æ§ãˆã‚ï¼ˆåå·®å€¤45æœªæº€ï¼‰ã§ã™ãŒã€ãƒ‹ãƒƒãƒé ˜åŸŸãƒ»åœ°æ–¹æ¡ˆä»¶ãƒ»ä¸­å°å„ªè‰¯ä¼æ¥­ãªã©æˆ¦ã„ã‚„ã™ã„å ´æ‰€ã‚‚å¤šãå­˜åœ¨ã—ã¾ã™ã€‚";
      }

      const gains = [];

      if (gpaBand < 0.5) {
        gains.push("ãƒ»æˆç¸¾/GPAå¸¯ã‚’ä¸€æ®µä¸Šã’ã‚‹ï¼ˆæˆæ¥­ãƒ»ãƒ¬ãƒãƒ¼ãƒˆãƒ»å°‘æ•°ã®ç§‘ç›®ã§ãƒ†ã‚³å…¥ã‚Œï¼‰");
      }
      if (intern < 1.0) {
        gains.push("ãƒ»é•·æœŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã¾ãŸã¯è·ç¨®ç›´çµã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ç¾å ´çµŒé¨“ã‚’ç©ã‚€");
      }
      if (english < 1.0) {
        gains.push("ãƒ»è‹±èªåŠ›ï¼ˆTOEIC750ã€œï¼‰ã‚’ç‹™ã„ã€æ›¸é¡é€šéãƒ©ã‚¤ãƒ³ã‚’è¶…ãˆã¦ãŠã");
      }
      if (cert < 1.0) {
        gains.push("ãƒ»å¿—æœ›è·ç¨®ã¨ç›´çµã—ãŸè³‡æ ¼/ã‚¹ã‚­ãƒ«ï¼ˆç°¿è¨˜ãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰è³‡æ ¼ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³»ãªã©ï¼‰ã‚’ä¸€ã¤ç©ã‚€");
      }

      commentEl.innerHTML = `
        <h4>ç·è©•ï¼ˆãƒ¢ãƒ‡ãƒ«ãƒ™ãƒ¼ã‚¹ï¼‰</h4>
        <p>å°±è·åŠ›åå·®å€¤ï¼š<strong>${res.hensachiJob}</strong> ï¼ 30æ­³æƒ³å®šå¹´åãƒ¬ãƒ³ã‚¸ï¼š<strong>${fmtMoneyMan(
          res.medianIncome
        )}ã€œ${fmtMoneyMan(res.p80Income)}</strong></p>
        <p>${posComment}</p>
        ${
          gains.length
            ? `<p>ãƒ¢ãƒ‡ãƒ«ä¸Šã€ä¼¸ã³ã—ã‚ãŒå¤§ãã„ã¨æƒ³å®šã•ã‚Œã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</p><ul>${gains
                .map(g => `<li>${g}</li>`)
                .join("")}</ul>`
            : `<p>å…¥åŠ›æ¡ä»¶ä¸Šã€å€‹äººå´ã®ç©ã¿ä¸Šã’è¦ç´ ã‚‚ã‹ãªã‚Šé«˜æ°´æº–ã«ãªã£ã¦ã„ã¾ã™ã€‚ã‚ã¨ã¯å¿—æœ›æ¥­ç•Œãƒ»è·ç¨®ã¨ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã¨ã€é¢æ¥ã§ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆè¨­è¨ˆãŒå‹è² ã«ãªã‚Šã¾ã™ã€‚</p>`
        }
      `;
    }

    runBtn.addEventListener("click", render);
    render();
  })();

  // ===== å®¶è¨ˆãƒ»DSCRãƒ¢ãƒ¼ãƒ‰ =====
  function calcHousehold(params) {
    const { income, expense, loan, assets } = params;
    const safeExpense = expense > 0 ? expense : 1;

    let dscr = null;
    if (loan > 0) {
      dscr = (income - expense) / loan;
    }

    const fiYears = assets / safeExpense;

    let dscrHen = null;
    if (dscr !== null) {
      const dscrClamped = clamp(dscr, 0, 3);
      dscrHen = clamp(50 + (dscrClamped - 1) * 20, 20, 80);
    }

    const fiClamped = clamp(fiYears, 0, 40);
    const fiHen = clamp(50 + (fiClamped - 10) * 1.5, 20, 80);

    let totalHen;
    if (dscrHen === null) {
      totalHen = fiHen;
    } else {
      totalHen = 0.6 * dscrHen + 0.4 * fiHen;
    }

    return {
      dscr,
      fiYears,
      dscrHen,
      fiHen,
      totalHen: roundTo(totalHen, 1)
    };
  }

  (function initHousehold() {
    const runBtn = document.getElementById("hh-run");
    const summary = document.getElementById("hh-summary");
    const tbody = document.querySelector("#hh-table tbody");
    const commentEl = document.getElementById("hh-comment");

    function render() {
      const income = parseFloat(document.getElementById("hh-income").value) || 0;
      const expense = parseFloat(document.getElementById("hh-expense").value) || 0;
      const loan = parseFloat(document.getElementById("hh-loan").value) || 0;
      const assets = parseFloat(document.getElementById("hh-assets").value) || 0;

      const res = calcHousehold({ income, expense, loan, assets });

      summary.innerHTML = "";
      tbody.innerHTML = "";

      const makePill = (label, value, tag, tone) => {
        const div = document.createElement("div");
        div.className = "metric-pill";
        const labelDiv = document.createElement("div");
        labelDiv.className = "metric-label";
        labelDiv.textContent = label;
        const valueDiv = document.createElement("div");
        valueDiv.className = "metric-value";
        valueDiv.textContent = value;
        if (tone === "good") valueDiv.style.color = "var(--success)";
        if (tone === "warn") valueDiv.style.color = "var(--danger)";
        const tagSpan = document.createElement("span");
        tagSpan.className = "metric-tag";
        tagSpan.textContent = tag;
        div.appendChild(labelDiv);
        div.appendChild(valueDiv);
        div.appendChild(tagSpan);
        return div;
      };

      if (res.dscr !== null) {
        summary.appendChild(
          makePill(
            "å®¶è¨ˆDSCR",
            roundTo(res.dscr, 2).toString(),
            "1.3ä»¥ä¸Šã§ã‚„ã‚„å®‰å…¨",
            res.dscr >= 1.5 ? "good" : res.dscr < 1.0 ? "warn" : null
          )
        );
      } else {
        summary.appendChild(
          makePill(
            "å®¶è¨ˆDSCR",
            "ãƒ­ãƒ¼ãƒ³ãªã—",
            "å€Ÿå…¥ãŒç„¡ã„ãŸã‚DSCRã¯æœªå®šç¾©",
            "good"
          )
        );
      }

      summary.appendChild(
        makePill(
          "FIå¹´æ•°ï¼ˆè³‡ç”£ã ã‘ã§æš®ã‚‰ã›ã‚‹å¹´æ•°ï¼‰",
          roundTo(res.fiYears, 1) + " å¹´",
          "10å¹´ä»¥ä¸Šã§ã‚„ã‚„å®‰å¿ƒ",
          res.fiYears >= 20 ? "good" : res.fiYears < 5 ? "warn" : null
        )
      );

      summary.appendChild(
        makePill(
          "å®¶è¨ˆç·åˆåå·®å€¤",
          res.totalHen.toFixed(1),
          "DSCRÃ—FIå¹´æ•°ãƒ¢ãƒ‡ãƒ«",
          null
        )
      );

      const rows = [];

      if (res.dscr !== null) {
        let comment;
        if (res.dscr < 1.0) {
          comment =
            "ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆã§æ‰‹ä¸€æ¯ã«ãªã‚Šã‚„ã™ã„æ°´æº–ã€‚è¿”æ¸ˆé¡ã®èª¿æ•´ã‚„ç”Ÿæ´»è²»ã®è¦‹ç›´ã—ã‚’å¼·ãæ¤œè¨ã—ãŸã„ã‚¾ãƒ¼ãƒ³ã§ã™ã€‚";
        } else if (res.dscr < 1.3) {
          comment =
            "ã‚®ãƒªã‚®ãƒªé»’å­—ã€œã‚„ã‚„ä½™è£•ãƒ¬ãƒ™ãƒ«ã€‚çªç™ºæ”¯å‡ºã¸ã®å‚™ãˆã‚„ãƒœãƒ¼ãƒŠã‚¹ä¾å­˜åº¦ã‚’ç¢ºèªã—ãŸã„ã‚¾ãƒ¼ãƒ³ã§ã™ã€‚";
        } else if (res.dscr < 1.8) {
          comment =
            "æ¯”è¼ƒçš„ä½™è£•ã®ã‚ã‚‹è¿”æ¸ˆãƒãƒ©ãƒ³ã‚¹ã€‚é•·æœŸçš„ãªæŠ•è³‡ãƒ»ç¹°ä¸Šè¿”æ¸ˆã‚’æ¤œè¨ã—ã‚„ã™ã„ãƒ¬ãƒ³ã‚¸ã§ã™ã€‚";
        } else {
          comment =
            "ã‹ãªã‚Šä½™è£•ã®ã‚ã‚‹è¿”æ¸ˆãƒãƒ©ãƒ³ã‚¹ã€‚ãƒªã‚¹ã‚¯è¨±å®¹åº¦ã‚’è¸ã¾ãˆã¤ã¤ã€å°†æ¥ã®é¸æŠè‚¢ã‚’åºƒã’ã‚‹æŠ•è³‡ãƒ»è‡ªå·±æŠ•è³‡ã®ä½™åœ°ã‚‚å¤§ãã„çŠ¶æ…‹ã§ã™ã€‚";
        }
        rows.push({
          label: "å®¶è¨ˆDSCR",
          value:
            res.dscr === null ? "ãƒ­ãƒ¼ãƒ³ãªã—" : roundTo(res.dscr, 2).toString(),
          hen: res.dscrHen === null ? "-" : res.dscrHen.toFixed(1),
          comment
        });
      } else {
        rows.push({
          label: "å®¶è¨ˆDSCR",
          value: "ãƒ­ãƒ¼ãƒ³ãªã—",
          hen: "-",
          comment:
            "ä½å®…ãƒ­ãƒ¼ãƒ³ãªã©ã®å¤§ããªå€Ÿå…¥ãŒç„¡ã„ãŸã‚ã€DSCRã¯å®šç¾©ã•ã‚Œã¾ã›ã‚“ã€‚å®¶è¨ˆã¨ã—ã¦ã¯å‚µå‹™ãƒªã‚¹ã‚¯ã¯ä½ã„çŠ¶æ…‹ã¨ã„ãˆã¾ã™ã€‚"
        });
      }

      let fiComment;
      if (res.fiYears < 3) {
        fiComment =
          "FIå¹´æ•°ã¯3å¹´æœªæº€ã€‚ç”Ÿæ´»é˜²è¡›è³‡é‡‘ã‚’åšã‚ã«ç¢ºä¿ã—ã¤ã¤ã€ç”Ÿæ´»è²»ã®å›ºå®šéƒ¨åˆ†ã‚’åœ§ç¸®ã™ã‚‹ä½™åœ°ãŒãªã„ã‹ç¢ºèªã—ãŸã„ã‚¾ãƒ¼ãƒ³ã§ã™ã€‚";
      } else if (res.fiYears < 10) {
        fiComment =
          "FIå¹´æ•°ã¯3ã€œ10å¹´ç¨‹åº¦ã€‚å¤§ããªãƒªã‚¹ã‚¯ã¯å–ã‚Šã¥ã‚‰ã„ãŒã€è¨ˆç”»çš„ãªæŠ•è³‡ã¨ã‚­ãƒ£ãƒªã‚¢æˆ¦ç•¥ã§å¾ã€…ã«å¹´æ•°ã‚’ä¼¸ã°ã—ã¦ã„ã‘ã‚‹ãƒ¬ãƒ³ã‚¸ã§ã™ã€‚";
      } else if (res.fiYears < 20) {
        fiComment =
          "FIå¹´æ•°ã¯10ã€œ20å¹´ã€‚ã‹ãªã‚Šåšã‚ã®è³‡ç”£ã‚¯ãƒƒã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã€ã‚­ãƒ£ãƒªã‚¢ãƒã‚§ãƒ³ã‚¸ã‚„åƒãæ–¹ã®è‡ªç”±åº¦ã‚’é«˜ã‚ã‚„ã™ã„çŠ¶æ…‹ã§ã™ã€‚";
      } else {
        fiComment =
          "FIå¹´æ•°ã¯20å¹´ä»¥ä¸Šã€‚å®¶è¨ˆã¨ã—ã¦ã¯ã»ã¼ã€ŒåŠFIã€œFIã€ã‚¾ãƒ¼ãƒ³ã«è¿‘ãã€åƒãæ–¹ãƒ»ä½ã¾ã„æ–¹ã®è‡ªç”±åº¦ãŒéå¸¸ã«é«˜ã„çŠ¶æ…‹ã§ã™ã€‚";
      }

      rows.push({
        label: "FIå¹´æ•°",
        value: roundTo(res.fiYears, 1) + " å¹´",
        hen: res.fiHen.toFixed(1),
        comment: fiComment
      });

      rows.push({
        label: "å®¶è¨ˆç·åˆåå·®å€¤",
        value: res.totalHen.toFixed(1),
        hen: res.totalHen.toFixed(1),
        comment:
          "DSCRï¼ˆã‚ã‚Œã°ï¼‰ã¨FIå¹´æ•°ã‚’6:4ã§åˆæˆã—ãŸãƒ¢ãƒ‡ãƒ«åå·®å€¤ã§ã™ã€‚50å‰å¾ŒãŒã€Œå¹³å‡çš„ãªå®¶è¨ˆãƒãƒ©ãƒ³ã‚¹ã€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚"
      });

      rows.forEach(r => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${r.label}</td>
          <td>${r.value}</td>
          <td>${r.hen}</td>
          <td>${r.comment}</td>
        `;
        tbody.appendChild(tr);
      });

      commentEl.innerHTML = `
        <h4>ç·è©•ï¼ˆãƒ¢ãƒ‡ãƒ«ãƒ™ãƒ¼ã‚¹ï¼‰</h4>
        <p>
          ä¸–å¸¯å¹´åï¼š<strong>${fmtMoneyMan(
            income
          )}</strong> ï¼ ç”Ÿæ´»è²»ï¼š<strong>${fmtMoneyMan(
        expense
      )}</strong> ï¼ ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆï¼š<strong>${fmtMoneyMan(
        loan
      )}</strong> ï¼ è³‡ç”£ï¼š<strong>${fmtMoneyMan(assets)}</strong>
        </p>
        <p>
          å®¶è¨ˆç·åˆåå·®å€¤ã¯ <strong>${res.totalHen.toFixed(
            1
          )}</strong> ã§ã—ãŸã€‚ã“ã‚Œã¯ã€ŒDSCRï¼ˆè¿”æ¸ˆä½™åŠ›ï¼‰ã¨FIå¹´æ•°ï¼ˆè³‡ç”£ã‚¯ãƒƒã‚·ãƒ§ãƒ³ï¼‰ã€ã®ãƒãƒ©ãƒ³ã‚¹ã‹ã‚‰è¦‹ãŸãƒ¢ãƒ‡ãƒ«ä¸Šã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã§ã™ã€‚
        </p>
      `;
    }

    runBtn.addEventListener("click", render);
    render();
  })();

  // ===== åœ°é ­ãƒŸãƒ‹IQï¼ˆç°¡æ˜“ç‰ˆï¼‰ =====
  const iqQuestions = [
    {
      id: 1,
      cat: "L",
      text: "3, 5, 9, 17, 33, ... ã«ç¶šãæ•°ã¨ã—ã¦æœ€ã‚‚é©åˆ‡ãªã®ã¯ï¼Ÿ",
      choices: ["49", "57", "65", "81"],
      correct: 1
    },
    {
      id: 2,
      cat: "L",
      text: "ã‚ã‚‹å·¥å ´ã§1å°ã®æ©Ÿæ¢°ã¯2æ™‚é–“ã§è£½å“ã‚’10å€‹ä½œã‚Šã¾ã™ã€‚åŒã˜æ€§èƒ½ã®æ©Ÿæ¢°3å°ã§6æ™‚é–“ç¨¼åƒã—ãŸã¨ãã€è£½å“ã¯ã„ãã¤ã§ãã¾ã™ã‹ï¼Ÿ",
      choices: ["60å€‹", "80å€‹", "90å€‹", "100å€‹"],
      correct: 2
    },
    {
      id: 3,
      cat: "L",
      text: "Aã•ã‚“ã¯Bã•ã‚“ã‚ˆã‚Š3æ­³å¹´ä¸Šã§ã™ã€‚5å¹´å¾Œã€Aã•ã‚“ã¯Bã•ã‚“ã®å¹´é½¢ã®1.1å€ã«ãªã‚Šã¾ã™ã€‚ç¾åœ¨ã®Bã•ã‚“ã®å¹´é½¢ã¯ã„ãã¤ï¼Ÿ",
      choices: ["20æ­³", "25æ­³", "30æ­³", "35æ­³"],
      correct: 2
    },
    {
      id: 4,
      cat: "P",
      text: "2Dã®å›³å½¢ã§ã€æ­£æ–¹å½¢â†’ã²ã—å½¢â†’æ­£æ–¹å½¢â†’ã²ã—å½¢â€¦ã¨å›è»¢ã—ã¦ã„ããƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚4å›ç›®ã®å›³å½¢ã¯ï¼Ÿ",
      choices: ["æ­£æ–¹å½¢", "ã²ã—å½¢", "ä¸‰è§’å½¢", "å††"],
      correct: 0
    },
    {
      id: 5,
      cat: "P",
      text: "â—‹ â–³ â–¡ â—‹ â–³ â–¡ ... ã¨3ã¤ã®å›³å½¢ãŒç¹°ã‚Šè¿”ã•ã‚Œã‚‹åˆ—ã§ã€15ç•ªç›®ã®å›³å½¢ã¯ï¼Ÿ",
      choices: ["â—‹", "â–³", "â–¡", "ã‚ã‹ã‚‰ãªã„"],
      correct: 2
    },
    {
      id: 6,
      cat: "P",
      text: "ç«‹æ–¹ä½“ã®å±•é–‹å›³ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã‚’é¸ã¶å•é¡Œã ã¨ã—ãŸã¨ãã€æœ€ã‚‚ä¸è‡ªç„¶ãªã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿï¼ˆç›´æ„Ÿã§OKï¼‰",
      choices: ["å‘ã‹ã„åˆã†é¢ãŒé‡ãªã‚‰ãªã„ã‚‚ã®", "æ­£æ–¹å½¢ãŒ6æšé€£ãªã£ãŸã‚‚ã®", "Tå­—å‹ã®ã‚‚ã®", "ä¸€ç›´ç·šã«6æšä¸¦ã‚“ã ã‚‚ã®"],
      correct: 3
    },
    {
      id: 7,
      cat: "V",
      text: "ã€Œç†±ã„ã€ãŒã€Œå†·ãŸã„ã€ã¨é–¢ä¿‚ã™ã‚‹ã¨ãã€ã€Œæ˜ã‚‹ã„ã€ã«å¯¾å¿œã™ã‚‹èªã¨ã—ã¦æœ€ã‚‚è¿‘ã„ã®ã¯ï¼Ÿ",
      choices: ["é‡ã„", "æš—ã„", "çœ©ã—ã„", "é‹­ã„"],
      correct: 1
    },
    {
      id: 8,
      cat: "V",
      text: "ã€ŒåŸå› ã€ã«å¯¾ã—ã¦æœ€ã‚‚è¿‘ã„é–¢ä¿‚ã«ã‚ã‚‹èªã®çµ„ã¿åˆã‚ã›ã¯ï¼Ÿ",
      choices: ["è³ªå•ï¼šç­”ãˆ", "å•é¡Œï¼šè§£æ±º", "å‰æï¼šçµè«–", "ææ–™ï¼šæ–™ç†"],
      correct: 3
    },
    {
      id: 9,
      cat: "V",
      text: "æ¬¡ã®ã†ã¡ã€ŒæŠ½è±¡çš„ãªæ¦‚å¿µã€ã«æœ€ã‚‚è¿‘ã„èªã¯ã©ã‚Œï¼Ÿ",
      choices: ["æœº", "ãƒªãƒ³ã‚´", "è‡ªç”±", "é›¨"],
      correct: 2
    },
    {
      id: 10,
      cat: "M",
      text: "ã€Œ7, 4, 9, 2ã€ã¨ã„ã†4ã¤ã®æ•°å­—ã‚’è¦‹ãŸã¨ã—ã¾ã™ã€‚æ•°ç§’å¾Œã€ã€Œ4ç•ªç›®ã®æ•°å­—ã€ã¯ï¼Ÿ",
      choices: ["2", "4", "7", "9"],
      correct: 0
    },
    {
      id: 11,
      cat: "M",
      text: "è²·ã„ç‰©ãƒ¡ãƒ¢ã€Œç‰›ä¹³ãƒ»åµãƒ»ãƒ‘ãƒ³ãƒ»ã‚Šã‚“ã”ãƒ»ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆã€ã‚’è¦šãˆã¾ã™ã€‚æ¬¡ã®ã†ã¡ãƒªã‚¹ãƒˆã«<strong>ãªã‹ã£ãŸ</strong>ã‚‚ã®ã¯ï¼Ÿ",
      choices: ["ç‰›ä¹³", "åµ", "ãƒãƒŠãƒŠ", "ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆ"],
      correct: 2
    },
    {
      id: 12,
      cat: "M",
      text: "3, 8, 5, 1, 9 ã¨ã„ã†åˆ—ã‚’é€†ã‹ã‚‰ä¸¦ã¹ã‚‹ã¨ï¼Ÿ",
      choices: ["1, 3, 5, 8, 9", "9, 1, 5, 8, 3", "9, 5, 1, 8, 3", "9, 3, 1, 5, 8"],
      correct: 1
    }
  ];

  function calcIqScores(answers) {
    let rawScore = 0;
    const catScores = { L: 0, P: 0, V: 0, M: 0 };

    iqQuestions.forEach((q, idx) => {
      const ans = answers[idx];
      if (ans === q.correct) {
        rawScore += 1;
        catScores[q.cat] += 1;
      }
    });

    const modelMean = 6;
    const modelSd = 2;
    const z = (rawScore - modelMean) / modelSd;
    const iqLike = clamp(Math.round(100 + z * 15), 70, 130);
    const hensachi = clamp(Math.round(50 + (iqLike - 100) * (10 / 15)), 30, 70);

    const catHens = {};
    ["L", "P", "V", "M"].forEach(cat => {
      const s = catScores[cat];
      const base = 30 + (s / 3) * 40;
      catHens[cat] = Math.round(base);
    });

    return {
      rawScore,
      iqLike,
      hensachi,
      catScores,
      catHens
    };
  }

  (function initIq() {
    const listEl = document.getElementById("iq-quiz-list");
    const progressText = document.getElementById("iq-progress-text");
    const runBtn = document.getElementById("iq-run");
    const resetBtn = document.getElementById("iq-reset");
    const summary = document.getElementById("iq-summary");
    const detail = document.getElementById("iq-detail");

    const answers = new Array(iqQuestions.length).fill(null);

    function renderQuestions() {
      listEl.innerHTML = "";
      iqQuestions.forEach((q, idx) => {
        const li = document.createElement("li");
        li.className = "quiz-item";
        const catLabel = { L: "Lï¼ˆè«–ç†ãƒ»æ•°ç†ï¼‰", P: "Pï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰", V: "Vï¼ˆè¨€èªï¼‰", M: "Mï¼ˆè¨˜æ†¶ï¼‰" }[q.cat] || q.cat;
        li.innerHTML = `
          <div class="quiz-q-header">
            <span>ç¬¬ ${q.id} å• <span style="color: var(--accent-strong);">${catLabel}</span></span>
            <span style="color: var(--text-soft); font-size: 10px;">ç›´æ„Ÿã§OK</span>
          </div>
          <div class="quiz-q-text">${q.text}</div>
          <div class="quiz-choices"></div>
        `;
        const choicesEl = li.querySelector(".quiz-choices");
        q.choices.forEach((cText, cIdx) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "quiz-choice";
          if (answers[idx] === cIdx) {
            btn.classList.add("selected");
          }
          btn.innerHTML = `<span>${String.fromCharCode(65 + cIdx)}.</span> ${cText}`;
          btn.addEventListener("click", () => {
            answers[idx] = cIdx;
            renderQuestions();
            updateProgress();
          });
          choicesEl.appendChild(btn);
        });
        listEl.appendChild(li);
      });
    }

    function updateProgress() {
      const count = answers.filter(a => a !== null).length;
      progressText.textContent = `${count} / ${iqQuestions.length} å•`;
    }

    function run() {
      if (answers.some(a => a === null)) {
        if (!confirm("æœªå›ç­”ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã¾ã¾æ¡ç‚¹ã—ã¾ã™ã‹ï¼Ÿ")) {
          return;
        }
      }
      const res = calcIqScores(answers);
      summary.innerHTML = "";

      const makePill = (label, value, tag) => {
        const div = document.createElement("div");
        div.className = "metric-pill";
        const labelDiv = document.createElement("div");
        labelDiv.className = "metric-label";
        labelDiv.textContent = label;
        const valueDiv = document.createElement("div");
        valueDiv.className = "metric-value";
        valueDiv.textContent = value;
        const tagSpan = document.createElement("span");
        tagSpan.className = "metric-tag";
        tagSpan.textContent = tag;
        div.appendChild(labelDiv);
        div.appendChild(valueDiv);
        div.appendChild(tagSpan);
        return div;
      };

      summary.appendChild(
        makePill("åœ°é ­åå·®å€¤ï¼ˆèªçŸ¥ï¼‰", res.hensachi, "ãƒ¢ãƒ‡ãƒ«ãƒ™ãƒ¼ã‚¹")
      );
      summary.appendChild(
        makePill("IQãƒ©ã‚¤ã‚¯ã‚¹ã‚³ã‚¢", res.iqLike, "å¹³å‡100 / SD15ãƒ¢ãƒ‡ãƒ«")
      );
      summary.appendChild(
        makePill("æ­£ç­”æ•°", `${res.rawScore} / ${iqQuestions.length}`, "ãƒŸãƒ‹ãƒ†ã‚¹ãƒˆã‚¹ã‚³ã‚¢")
      );

      const catNames = {
        L: "è«–ç†ãƒ»æ•°ç†",
        P: "ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»ç©ºé–“",
        V: "è¨€èªãƒ»é¡æ¨",
        M: "ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒª"
      };

      const catLines = Object.keys(res.catHens).map(cat => {
        return `${catNames[cat]}ï¼šåå·®å€¤ ${res.catHens[cat]}ï¼ˆæ­£ç­” ${res.catScores[cat]} å•ï¼‰`;
      });

      let profileComment = "";
      if (res.catHens.L >= res.catHens.P && res.catHens.L >= res.catHens.V) {
        profileComment += "ãƒ»è«–ç†ãƒ»æ•°ç†ãŒæ¯”è¼ƒçš„å¼·ã‚ã§ã€ä»•çµ„ã¿ã‚„åŸå› ã‚’æ•´ç†ã—ã¦è€ƒãˆã‚‹æ€è€ƒã‚¹ã‚¿ã‚¤ãƒ«ãŒå‘ã„ã¦ã„ã‚‹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚\n";
      }
      if (res.catHens.P >= 60) {
        profileComment += "ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ãŒé«˜ã‚ã§ã€å›³å½¢ã‚„é–¢ä¿‚æ€§ã®ãƒ«ãƒ¼ãƒ«ã‚’è¦‹æŠœãã®ãŒå¾—æ„ãªå‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚\n";
      }
      if (res.catHens.V >= 60) {
        profileComment += "ãƒ»è¨€èªãƒ»é¡æ¨åŠ›ãŒé«˜ã‚ã§ã€è¨€è‘‰ã‚„æ¦‚å¿µã®ã¤ãªãŒã‚Šã‚’æ‰±ã†ä»•äº‹ãƒ»å­¦ã³æ–¹ã¨ç›¸æ€§ãŒè‰¯ã•ãã†ã§ã™ã€‚\n";
      }
      if (res.catHens.M >= 60) {
        profileComment += "ãƒ»ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªãŒé«˜ã‚ã§ã€è¤‡æ•°ã®æƒ…å ±ã‚’ä¸€æ™‚çš„ã«ä¿æŒã—ãªãŒã‚‰å‡¦ç†ã™ã‚‹ã‚¿ã‚¹ã‚¯ã«å¼·ã¿ãŒå‡ºã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚\n";
      }
      if (!profileComment) {
        profileComment =
          "ãƒ»å„ã‚«ãƒ†ã‚´ãƒªã¯ãŠãŠã‚€ã­å¹³å‡ã€œã‚„ã‚„ä¸Šç¨‹åº¦ã«åã¾ã£ã¦ãŠã‚Šã€ãƒãƒ©ãƒ³ã‚¹å‹ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚ç‰¹å®šã®å°–ã‚Šã‚’ä½œã‚‹ã‚ˆã‚Šã‚‚ã€ç’°å¢ƒé¸ã³ã‚„EQãƒ»ä¾¡å€¤è¦³ã¨ã®çµ„ã¿åˆã‚ã›ã§é©æ€§ãŒæ±ºã¾ã‚Šã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã¨è¨€ãˆã¾ã™ã€‚";
      }

      detail.innerHTML = `
        <h4>ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</h4>
        <p>${catLines.join("<br>")}</p>
        <p>â€» v0ã¯ã‚µãƒ³ãƒ—ãƒ«å•é¡Œã«åŸºã¥ãã–ã£ãã‚Šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚æœ¬ç•ªç‰ˆã§ã¯å•é¡Œãƒãƒ³ã‚¯ã¨å®Ÿæ¸¬åˆ†å¸ƒã‚’ç”¨ã„ã¦ç²¾åº¦ã‚’é«˜ã‚ã¾ã™ã€‚</p>
        <h4>ã–ã£ãã‚Šã‚¿ã‚¤ãƒ—ã‚³ãƒ¡ãƒ³ãƒˆ</h4>
        <p style="white-space: pre-line;">${profileComment}</p>
      `;
    }

    function reset() {
      for (let i = 0; i < answers.length; i++) {
        answers[i] = null;
      }
      renderQuestions();
      updateProgress();
      summary.innerHTML = "";
      detail.innerHTML = `
        <p>ã¾ã æ¡ç‚¹ã—ã¦ã„ã¾ã›ã‚“ã€‚ã€Œåœ°é ­åå·®å€¤ã‚’ç®—å‡ºã€ã‚’æŠ¼ã™ã¨çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
      `;
    }

    runBtn.addEventListener("click", run);
    resetBtn.addEventListener("click", reset);

    renderQuestions();
    updateProgress();
  })();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>人生偏差値ラボ（高校生版ミニツール）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --bg-card: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
      --border: #1f2937;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 20px 40px rgba(15, 23, 42, 0.45);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    .page {
      width: 100%;
      max-width: 960px;
      padding: 24px 16px 40px;
    }

    header {
      margin-bottom: 24px;
    }

    .title {
      font-size: 1.8rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.6rem;
      margin-bottom: 6px;
    }

    .badge {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--accent);
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .subtitle {
      font-size: 0.9rem;
      color: var(--muted);
      max-width: 36rem;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.6fr);
      gap: 16px;
    }

    @media (max-width: 768px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: linear-gradient(145deg, #020617, #020617, #020617);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148, 163, 184, 0.08);
      padding: 18px 18px 20px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -120px;
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.18),
        transparent 60%
      );
      opacity: 0.5;
      pointer-events: none;
    }

    .card-content {
      position: relative;
      z-index: 1;
    }

    .card h2 {
      font-size: 1.1rem;
      margin: 0 0 12px;
    }

    .card p {
      margin: 0;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .field-group {
      margin-top: 14px;
    }

    .field-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pill-toggle {
      display: inline-flex;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      padding: 3px;
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .pill-toggle button {
      border: none;
      padding: 4px 12px;
      font-size: 0.8rem;
      border-radius: 999px;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .pill-toggle button.active {
      background: linear-gradient(135deg, #38bdf8, #22c55e);
      color: #020617;
      font-weight: 600;
    }

    .slider-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    input[type="range"] {
      width: 100%;
      accent-color: var(--accent);
    }

    .value-badge {
      min-width: 58px;
      text-align: center;
      padding: 4px 8px;
      font-size: 0.8rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .hint {
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 4px;
      line-height: 1.4;
    }

    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 10px;
    }

    .results-header-title {
      font-size: 0.95rem;
      font-weight: 600;
    }

    .results-header-sub {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .scenario-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    @media (max-width: 768px) {
      .scenario-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .scenario-card {
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.2);
      background: radial-gradient(
          circle at top,
          rgba(56, 189, 248, 0.12),
          transparent 60%
        ),
        rgba(15, 23, 42, 0.96);
      padding: 10px 10px 12px;
      font-size: 0.82rem;
    }

    .scenario-title {
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 4px;
    }

    .scenario-tag {
      font-size: 0.7rem;
      padding: 1px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: var(--muted);
    }

    .scenario-tag.primary {
      border-color: var(--accent);
      color: var(--accent);
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      margin-top: 3px;
    }

    .stat-label {
      color: var(--muted);
    }

    .stat-value {
      font-weight: 600;
    }

    .stat-value.highlight {
      color: var(--accent);
    }

    .stat-value.danger {
      color: var(--danger);
    }

    .small-note {
      font-size: 0.7rem;
      color: var(--muted);
      margin-top: 6px;
      line-height: 1.4;
    }

    .delta-text {
      font-size: 0.8rem;
      margin-top: 6px;
    }

    .delta-text strong {
      color: var(--accent);
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }

    .chip {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      color: var(--muted);
      background: rgba(15, 23, 42, 0.9);
    }

    .chip.strong {
      border-color: var(--accent);
      color: var(--accent);
    }

    footer {
      margin-top: 16px;
      font-size: 0.7rem;
      color: var(--muted);
      max-width: 40rem;
    }
  </style>
</head>
<body>
  <main class="page">
    <header>
      <div class="badge">prototype · single page</div>
      <div class="title">
        人生偏差値ラボ
        <span style="font-size:0.8rem; color:#9ca3af;">
          – 高校生版ミニシミュレーター
        </span>
      </div>
      <p class="subtitle">
        「今の偏差値のまま進む」のと「偏差値をあと5〜10上げてから進む」のでは、
        30歳前後の年収レンジがどれくらい変わりうるのかをざっくり可視化する試作ツールです。
        実際の人生はもっと複雑ですが、「今の勉強＝未来の選択肢の広さ」という感覚を掴むための方位磁石として使ってください。
      </p>
    </header>

    <section class="layout">
      <!-- 左：入力 -->
      <section class="card">
        <div class="card-content">
          <h2>1. 今の自分をセットする</h2>
          <p>
            今の模試偏差値と、ざっくりの進路イメージ（文系寄り・理系寄り）を入れてください。
            ここでは「全国の同年代」を前提にしたざっくりモデルで計算します。
          </p>

          <div class="field-group">
            <div class="field-label">文系 / 理系のイメージ</div>
            <div class="pill-toggle" id="trackToggle">
              <button type="button" data-track="arts" class="active">文系寄り</button>
              <button type="button" data-track="science">理系寄り</button>
            </div>
            <div class="hint">
              どちらか迷う場合は、<strong>「理系教科（数学・物理など）で勝負する気があるかどうか」</strong>で選んでOKです。
            </div>
          </div>

          <div class="field-group">
            <div class="field-label">今の模試偏差値（おおよそ）</div>
            <div class="slider-row">
              <input
                id="currentHen"
                type="range"
                min="40"
                max="70"
                step="1"
                value="50"
              />
              <div class="value-badge">
                <span id="currentHenValue">50</span>
              </div>
            </div>
            <div class="hint">
              実際の模試が 47〜53 あたりなら「50」、 52〜58 あたりなら「55」…のようにざっくりで大丈夫です。
            </div>
          </div>

          <div class="field-group">
            <div class="field-label">想定する「頑張り幅」</div>
            <p class="hint">
              このプロトタイプでは、<strong>今の偏差値</strong>・<strong>＋5</strong>・<strong>＋10</strong> の
              3パターンを自動で比較します。実際には「分野選び」も同じくらい重要ですが、
              まずは「偏差値だけ」を動かした場合のインパクトをイメージするためのモデルです。
            </p>
          </div>

          <div class="field-group">
            <div class="field-label">この画面でわかること</div>
            <div class="chip-row">
              <div class="chip strong">30歳前後の年収レンジの差</div>
              <div class="chip">生涯ベースのざっくり差額（万円）</div>
              <div class="chip">偏差値アップで広がる選択肢イメージ</div>
            </div>
          </div>
        </div>
      </section>

      <!-- 右：結果 -->
      <section class="card">
        <div class="card-content" id="results">
          <div class="results-header">
            <div>
              <div class="results-header-title">
                2. 30歳あたりの年収イメージ（試算）
              </div>
              <div class="results-header-sub">
                偏差値の違いによる「30歳時点の年収レンジ」と「ざっくり生涯差」を比較表示します。
              </div>
            </div>
          </div>

          <div class="scenario-grid" id="scenarioGrid">
            <!-- JSで差し込む -->
          </div>

          <div class="small-note">
            ※ 金額はすべて<strong>概算のモデル値</strong>です。実際の進路・分野選択・行動次第で大きく変わります。
            「偏差値に意味はない／偏差値がすべて」どちらでもなく、<strong>「選択肢を広げるための1つのレバー」</strong>として理解してください。
          </div>
        </div>
      </section>
    </section>

    <footer>
      このページは「人生偏差値アプリ」構想の
      <strong>高校生向けミニプロトタイプ</strong>です。将来的には、ここに
      <strong>学部・職種・会社・家計（DSCR）・副業 / YouTuber といった要素</strong>を追加して、
      「将来欲しい年収・就職力から逆算して進路を設計する」フル版へ拡張していく想定です。
    </footer>
  </main>

  <script>
    // ---- モデル部分（ざっくり試算ロジック） -----------------------------

    // 偏差値 → 30歳時点の年収（中央値 & 上位20%）をざっくり推定する。
    // 単位は「万円」。かなりラフなモデル。
    function estimateIncomeAt30(hen, track) {
      // モデル用のアンカー値（偏差値 vs 年収/万円）
      // 文系寄りのベース（理系は後で倍率で調整）
      const anchorsMedian = {
        45: 350,
        50: 400,
        55: 500,
        60: 600,
        65: 700
      };

      const anchorsP80 = {
        45: 450,
        50: 550,
        55: 650,
        60: 800,
        65: 900
      };

      function interp(obj, x) {
        const keys = Object.keys(obj)
          .map(Number)
          .sort((a, b) => a - b);
        if (x <= keys[0]) return obj[keys[0]];
        if (x >= keys[keys.length - 1]) return obj[keys[keys.length - 1]];
        for (let i = 0; i < keys.length - 1; i++) {
          const k1 = keys[i];
          const k2 = keys[i + 1];
          if (x >= k1 && x <= k2) {
            const t = (x - k1) / (k2 - k1);
            return obj[k1] + (obj[k2] - obj[k1]) * t;
          }
        }
        return obj[keys[0]];
      }

      const baseMedian = interp(anchorsMedian, hen);
      const baseP80 = interp(anchorsP80, hen);

      // 理系寄りのときは「専門職・技術職への接続」が強い想定で少しブースト
      const scienceBoost = track === "science" ? 1.1 : 1.0;

      return {
        median: Math.round(baseMedian * scienceBoost),
        p80: Math.round(baseP80 * scienceBoost)
      };
    }

    // 生涯差のざっくりモデル：30歳時点の年収差 × 35年。
    function estimateLifetimeDiff(medianBase, medianHigher) {
      const diffPerYear = medianHigher - medianBase; // 万円
      const years = 35; // 適当な就労年数モデル
      return diffPerYear > 0 ? diffPerYear * years : 0;
    }

    // ---- UI 更新ロジック ---------------------------------------------------

    function formatYenMan(man) {
      return man.toLocaleString("ja-JP") + "万円";
    }

    function updateScenarios() {
      const trackButton = document.querySelector(
        ".pill-toggle button.active"
      );
      const track = trackButton ? trackButton.dataset.track : "arts";

      const currentHen = Number(
        document.getElementById("currentHen").value
      );

      const scenarioGrid = document.getElementById("scenarioGrid");
      scenarioGrid.innerHTML = "";

      // シナリオ：今のまま / +5 / +10（上限65）
      const scenarios = [
        { label: "今のまま", delta: 0, primary: true },
        { label: "偏差値を＋5", delta: 5, primary: false },
        { label: "偏差値を＋10", delta: 10, primary: false }
      ];

      // ベースの結果（「今のまま」を基準に生涯差を出す）
      const baseHen = currentHen;
      const baseIncome = estimateIncomeAt30(baseHen, track);
      const cards = [];

      scenarios.forEach((sc) => {
        let targetHen = baseHen + sc.delta;
        if (targetHen > 65) targetHen = 65; // モデル上の上限

        const income = estimateIncomeAt30(targetHen, track);
        const lifetimeDiff =
          sc.delta === 0
            ? 0
            : estimateLifetimeDiff(baseIncome.median, income.median);

        cards.push({
          title: sc.label,
          hen: targetHen,
          median: income.median,
          p80: income.p80,
          lifetimeDiff,
          primary: sc.primary
        });
      });

      cards.forEach((c, idx) => {
        const div = document.createElement("div");
        div.className = "scenario-card";

        const isBase = idx === 0;
        const tagClass = c.primary ? "scenario-tag primary" : "scenario-tag";

        div.innerHTML = `
          <div class="scenario-title">
            <span>${c.title}</span>
            <span class="${tagClass}">
              偏差値 ${c.hen}
            </span>
          </div>
          <div class="stat-row" style="margin-top:6px;">
            <div class="stat-label">30歳あたりの年収（中央値）</div>
            <div class="stat-value ${
              isBase ? "" : "highlight"
            }">${formatYenMan(c.median)}</div>
          </div>
          <div class="stat-row">
            <div class="stat-label">上位20％ゾーン</div>
            <div class="stat-value">${formatYenMan(c.p80)}</div>
          </div>
          ${
            isBase
              ? `<div class="delta-text">
                    このシナリオが<strong>「今のまま」</strong>進んだ場合のざっくりイメージです。
                  </div>`
              : c.lifetimeDiff > 0
              ? `<div class="delta-text">
                    「今のまま」と比べて、<strong>生涯ベースで約 ${formatYenMan(
                      c.lifetimeDiff
                    )}</strong> 分だけ
                    「稼げる可能性のあるゾーン」が広がるイメージです（超ざっくり試算）。
                 </div>`
              : `<div class="delta-text">
                    このモデルでは「今のまま」と大きな差は出ていません。
                 </div>`
          }
        `;

        scenarioGrid.appendChild(div);
      });
    }

    // ---- イベント設定 ------------------------------------------------------

    document.addEventListener("DOMContentLoaded", () => {
      const currentHenInput = document.getElementById("currentHen");
      const currentHenValue = document.getElementById("currentHenValue");
      const trackToggle = document.getElementById("trackToggle");

      currentHenInput.addEventListener("input", () => {
        currentHenValue.textContent = currentHenInput.value;
        updateScenarios();
      });

      trackToggle.addEventListener("click", (e) => {
        const btn = e.target.closest("button[data-track]");
        if (!btn) return;
        trackToggle
          .querySelectorAll("button")
          .forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        updateScenarios();
      });

      // 初期表示
      updateScenarios();
    });
  </script>
</body>
</html>